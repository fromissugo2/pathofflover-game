<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Path of flover</title>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>

  <style>
    body {
      margin: 0;
      background: #000;
    }
  </style>
</head>
<body>

<script>
  const config = {
    type: Phaser.AUTO,
    width: 480,
    height: 270,
    backgroundColor: "#222222",
    physics: {
      default: "arcade",
      arcade: {
        gravity: { y: 600 },
        debug: false
      }
    },
    scene: {
      create,
      update
    }
  };

  new Phaser.Game(config);

  let player;
  let obstacle;
  let cursors;

  const PLAYER_SPEED = 100;
  const OBSTACLE_SPEED = 100;
  const JUMP_POWER = 260;
  const GROUND_Y = 220;

  function create() {
    /* =====================
       ë°”ë‹¥
    ===================== */
    const ground = this.add.rectangle(0, GROUND_Y, 480, 50, 0x555555);
    ground.setOrigin(0);
    this.physics.add.existing(ground, true);

    /* =====================
       í”Œë ˆì´ì–´ (í”Œë¡œë²„)
    ===================== */
    player = this.add.rectangle(420, GROUND_Y - 20, 16, 24, 0x00ff88);
    this.physics.add.existing(player);

    player.body.setCollideWorldBounds(true);
    this.physics.add.collider(player, ground);

    /* =====================
       ì¥ì• ë¬¼ (Graphics â†’ Texture)
    ===================== */
    const g = this.add.graphics();
    g.fillStyle(0xff0000, 1);
    g.fillRect(0, 0, 24, 32);
    g.generateTexture("obstacleTex", 24, 32);
    g.destroy();

    obstacle = this.physics.add.image(360, GROUND_Y - 16, "obstacleTex");

    obstacle.setVelocityX(-OBSTACLE_SPEED);
    obstacle.setImmovable(true);

    // ğŸ”‘ í•µì‹¬: ì¥ì• ë¬¼ì€ ì¤‘ë ¥ ì˜í–¥ X
    obstacle.body.allowGravity = false;

    this.physics.add.collider(obstacle, ground);
    this.physics.add.collider(player, obstacle, onHit);

    /* =====================
       í‚¤ ì…ë ¥
    ===================== */
    cursors = this.input.keyboard.createCursorKeys();
  }

  function onHit() {
    console.log("ğŸ’¥ HIT OBSTACLE");
  }

  function update() {
    /* í”Œë ˆì´ì–´ ìë™ ì´ë™ (â†) */
    player.body.setVelocityX(-PLAYER_SPEED);

    /* ì í”„ */
    if (cursors.space.isDown && player.body.blocked.down) {
      player.body.setVelocityY(-JUMP_POWER);
    }

    /* í™”ë©´ ë£¨í”„ */
    if (player.x < -10) {
      player.x = 490;
    }

    if (obstacle.x < -30) {
      obstacle.x = 480;
    }
  }
</script>

</body>
</html>
